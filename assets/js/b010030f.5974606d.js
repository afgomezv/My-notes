"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5039],{2988:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var s=r(4848),a=r(8453);const i={sidebar_position:4,title:"Mutaciones"},t=void 0,o={id:"graphql/mutations",title:"Mutaciones",description:"En el siguiente ejemplo vamor subir la complejida para poder aplicar las mutaciones, campos no triviales y manejo de errores.",source:"@site/data/graphql/mutations.md",sourceDirName:"graphql",slug:"/graphql/mutations",permalink:"/my-notes/data/graphql/mutations",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Mutaciones"},sidebar:"tutorialSidebar",previous:{title:"Ejemplos",permalink:"/my-notes/data/graphql/example-one"},next:{title:"Directivas y decoradores",permalink:"/my-notes/data/graphql/directivas"}},l={},d=[{value:"Orig\xe9n de datos",id:"orig\xe9n-de-datos",level:3},{value:"Definici\xf3n de tipos",id:"definici\xf3n-de-tipos",level:3},{value:"Resolvers y Mutaciones",id:"resolvers-y-mutaciones",level:3},{value:"Aplicado query en el servidor apollo",id:"aplicado-query-en-el-servidor-apollo",level:3}];function c(e){const n={code:"code",h3:"h3",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"En el siguiente ejemplo vamor subir la complejida para poder aplicar las mutaciones, campos no triviales y manejo de errores."}),"\n",(0,s.jsx)(n.h3,{id:"orig\xe9n-de-datos",children:"Orig\xe9n de datos"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'const users = [\r\n  {\r\n    id: 1,\r\n    name: "Catalina",\r\n    surname: "Casta\xf1o",\r\n    street: "Calle example 1",\r\n    zipCode: "20010",\r\n    city: "Madrid",\r\n    phone: "+346003214587",\r\n  },\r\n  {\r\n    id: 1,\r\n    name: "Kathe",\r\n    surname: "Higuita",\r\n    street: "Calle example 2",\r\n    zipCode: "22010",\r\n    city: "Madrid",\r\n    phone: "+3466003694587",\r\n  },\r\n];\n'})}),"\n",(0,s.jsx)(n.h3,{id:"definici\xf3n-de-tipos",children:"Definici\xf3n de tipos"}),"\n",(0,s.jsx)(n.p,{children:"En esta secci\xf3n definimos el tipo de usuario, la query y las mutaciones"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const typeDefs = `\r\n    type User {\r\n        id: ID!\r\n        name: String!\r\n        surname: String!\r\n        street: String!\r\n        zipCode: Int!\r\n        city: String!\r\n        phone: String\r\n        address: String\r\n    }\r\n        type Query {\r\n            allUsers: [User]\r\n            userCount: Int!\r\n            findUserByName(name:String!): User\r\n            findUserByID(id:ID!): User\r\n        }\r\n\r\n        type Mutation {\r\n            addUser(\r\n                name: String!\r\n                surname: String!\r\n                street: String!\r\n                zipCode: Int!\r\n                city: String!\r\n                phone: String\r\n            ): User\r\n        }\r\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"resolvers-y-mutaciones",children:"Resolvers y Mutaciones"}),"\n",(0,s.jsx)(n.p,{children:"En resolver realizamos la construcci\xf3n de los campos no triviales y la mutaci\xf3n en la creaci\xf3n del usuario con su manejo de error."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { GraphQLError } from "graphql";\r\n\r\nconst resolvers = {\r\n  User: {\r\n    address: (parent) => `${parent.street}, ${parent.zipCode}, ${parent.city}`,\r\n  },\r\n  Query: {\r\n    allUsers: () => users,\r\n    userCount: () => users.length,\r\n    findUserByName: (parent, args) =>\r\n      users.find((user) => user.name === args.name),\r\n    findUserByID: (parent, args) => users.find((user) => user.id === args.id),\r\n  },\r\n  Mutation: {\r\n    addUser: (parent, args) => {\r\n      if (users.find((user) => user.name === args.name)) {\r\n        throw new GraphQLError("The username already exists", {\r\n          extensions: { code: "BAD_USER_INPUT" },\r\n        });\r\n      }\r\n      const newUser = { ...args, id: uuid() };\r\n      users.push(newUser);\r\n      return newUser;\r\n    },\r\n  },\r\n};\n'})}),"\n",(0,s.jsx)(n.h3,{id:"aplicado-query-en-el-servidor-apollo",children:"Aplicado query en el servidor apollo"}),"\n",(0,s.jsx)(n.p,{children:"En la query consultamos a todos los usuarios y consultamos un usuario por su nombre."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"uery($name: String!) {\r\n  allUsers {\r\n    name,\r\n    surname,\r\n    address\r\n  }\r\n  findUserByName(name: $name) {\r\n    name,\r\n    surname\r\n  }\r\n}\r\n\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\r\n  "name": "Kathe"\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"En el siguiente paso es crear un usuario en Apollo server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"mutation($name: String!, $surname: String!, $street: String!, $zipCode: Int!, $city: String!) {\r\n  addUser(name: $name, surname: $surname, street: $street, zipCode: $zipCode, city: $city) {\r\n    id,\r\n    name\r\n  }\r\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\r\n  "name": "Danna",\r\n  "surname": "Jaramillo",\r\n  "street": "Car 53C #88-65",\r\n  "zipCode": 50014,\r\n  "city": "Bello"\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Ya podemos consultar al nuevo usuario"})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var s=r(6540);const a={},i=s.createContext(a);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);